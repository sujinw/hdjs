!function(e){function t(e){document.activeElement&&document.activeElement===e||e.focus()}e.fn.caret=function(e){var n=this[0],o="true"===n.contentEditable;if(0==arguments.length){if(window.getSelection){if(o){t(n);var r=window.getSelection();if(!r.rangeCount)return 0;var a=r.getRangeAt(0),c=a.cloneRange();return c.selectNodeContents(n),c.setEnd(a.endContainer,a.endOffset),c.toString().length}return n.selectionStart}if(document.selection){if(t(n),o){var a=document.selection.createRange(),c=document.body.createTextRange();return c.moveToElementText(n),c.setEndPoint("EndToEnd",a),c.text.length}var e=0,i=n.createTextRange(),c=document.selection.createRange().duplicate(),l=c.getBookmark();for(i.moveToBookmark(l);0!==i.moveStart("character",-1);)e++;return e}return 0}if(-1==e&&(e=this[o?"text":"val"]().length),window.getSelection)o?(t(n),window.getSelection().collapse(n.firstChild,e)):n.setSelectionRange(e,e);else if(document.body.createTextRange){var i=document.body.createTextRange();i.moveToElementText(n),i.moveStart("character",e),i.collapse(!0),i.select()}return o||t(n),e}}(jQuery);